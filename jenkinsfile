pipeline{
  agent any
  environment{
    user_credentials = credentials('trello_credentials')
  }
  parameters {
    string(name: 'browser', defaultValue: "CHROME")
  }
  triggers {
    cron('H H 1,15 1-11 *')
  }
  stages {
    stage("Test"){
      steps{
        bat """gradle clean trello-web-automation:executeFeature -DenvironmentName=QA -DcucumberTags="@board" -DuserName=$user_credentials_USR -DuserPassword=$user_credentials_PSW -Dbrowser=${params.browser}"""
        script {
                        allure([
                                includeProperties: false,
                                jdk: '',
                                properties: [],
                                reportBuildPolicy: 'ALWAYS',
                                results: [[path: "trello-web-automation/build/allure-results"]]
                        ])
                }
      }
    }
    stage('reports') {
        steps {
        script {
                allure([
                        includeProperties: false,
                        jdk: '',
                        properties: [],
                        reportBuildPolicy: 'ALWAYS',
                        results: [[path: "trello-web-automation/build/allure-results"]]
                ])
        }
        }
    }
  }
}
